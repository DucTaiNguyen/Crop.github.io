<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exercise JQuery</title>

    <style>
      * {
        padding: 0;
        margin: 0;
      }
      body {
        max-width: 100%;
      }
      main {
        width: 100%;
        margin: auto;
      }
      .faq {
        width: 100%;
      }
      .item {
        width: 100%;
      }
      .title {
        background-color: #eee;
        color: #444;
        cursor: pointer;
        height: 100%;
        border: none;
        text-align: left;
        outline: none;
        font-size: 15px;
        padding: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .title svg {
        width: 15px;
      }
      .icon {
        width: 15px;
        height: 1px;
        background: #000;
      }
      .icon::after {
        content: "";
        position: absolute;
        width: 15px;
        height: 1px;
        top: 27px;
        background: #000;
        transform: rotate(90deg);
        opacity: 1;
        transition: 0.3s;
      }

      .active {
        background-color: #ccc;
      }
      .active svg {
        transform: rotate(-180deg);
        transition: 0.2s;
      }

      .panel {
        display: none;
        padding: 0 18px;
        background-color: white;
        transition: max-height 0.2s ease-out;
      }
      .panel p {
        padding: 20px 0;
      }
      .tags {
        border: 1px solid rgb(129, 129, 129);
        padding: 8px;
        display: flex;
        align-items: center;
      }
      .tags input {
        width: 50%;
        padding: 8px;
        border: none;
      }
      .tags input:focus {
        outline: none;
      }
      .list .tag {
        display: inline-block;
        border-radius: 30px;
        background-color: aquamarine;
        color: #000;
        font-size: 14px;
        padding: 10px 12px;
        position: relative;
      }
      .remove {
        position: absolute;
        top: -8px;
        right: 8px;
        z-index: 30;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <!-- <form id="form-contact">
      <div class="form-group">
        <label>Họ và tên</label>
        <input type="text" name="name" class="form-control" />
      </div>
      <div class="form-group">
        <label>Địa chỉ Email</label>
        <input type="text" name="email" class="form-control" />
      </div>
      <div class="form-group">
        <label>Số điện thoại</label>
        <input type="number" name="telephone" class="form-control" />
      </div>
      <div class="form-group">
        <label>Nội dung</label>
        <textarea class="form-control" name="content" row="6"></textarea>
      </div>
      <div class="form-group">
        <label>Tỉnh thành</label>
        <select name="region" class="form-control">
          <option value="">Chọn tỉnh thành</option>
        </select>
      </div>
      <div class="form-group">
        <label>Huyện</label>
        <select name="city" class="form-control">
          <option value="">Chọn huyện</option>
        </select>
      </div>
      <div class="form-group">
        <label>Xã</label>
        <select name="ward" class="form-control">
          <option value="">Chọn xã</option>
        </select>
      </div>
      <div class="form-group d-flex justify-content-end">
        <button type="button" class="btnContact">Liên hệ</button>
      </div>
    </form> -->
    <main>
      <section class="faq pd">
        <div class="item">
          <div class="title">
            Section 1

            <svg
              version="1.1"
              id="Capa_1"
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              x="0px"
              y="0px"
              viewBox="0 0 256 256"
              style="enable-background: new 0 0 256 256"
              xml:space="preserve"
            >
              <g>
                <polygon
                  points="225.813,48.907 128,146.72 30.187,48.907 0,79.093 128,207.093 256,79.093 		"
                />
              </g>
            </svg>
          </div>
          <div class="panel">
            <p>
              Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do
              eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
              enim ad minim veniam, quis nostrud exercitation ullamco laboris
              nisi ut aliquip ex ea commodo consequat.
            </p>
          </div>
        </div>

        <div class="item">
          <div class="title">
            Section 2

            <svg
              version="1.1"
              id="Capa_1"
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              x="0px"
              y="0px"
              viewBox="0 0 256 256"
              style="enable-background: new 0 0 256 256"
              xml:space="preserve"
            >
              <g>
                <polygon
                  points="225.813,48.907 128,146.72 30.187,48.907 0,79.093 128,207.093 256,79.093 		"
                />
              </g>
            </svg>
          </div>
          <div class="panel">
            <p>
              Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do
              eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
              enim ad minim veniam, quis nostrud exercitation ullamco laboris
              nisi ut aliquip ex ea commodo consequat.
            </p>
          </div>
        </div>

        <div class="item">
          <div class="title">
            Section 3

            <svg
              version="1.1"
              id="Capa_1"
              xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              x="0px"
              y="0px"
              viewBox="0 0 256 256"
              style="enable-background: new 0 0 256 256"
              xml:space="preserve"
            >
              <g>
                <polygon
                  points="225.813,48.907 128,146.72 30.187,48.907 0,79.093 128,207.093 256,79.093 		"
                />
              </g>
            </svg>
          </div>
          <div class="panel">
            <p>
              Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do
              eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
              enim ad minim veniam, quis nostrud exercitation ullamco laboris
              nisi ut aliquip ex ea commodo consequat.
            </p>
          </div>
        </div>
      </section>

      <section>
        <h2>Tags</h2>
        <div class="tags">
          <div class="list">
            <div class="tag">
              training
              <span class="remove">x</span>
            </div>
          </div>
          <input type="text" name="tags" />
        </div>
      </section>
    </main>

    <script src="dest/jsmain.min.js"></script>
    <script>
      $(document).ready(function () {
        $(".btnContact").click(function (e) {
          // console.log("click");
          let name = $("input[name='name']").val();
          let email = $("input[name='email']").val();
          let telephone = $("input[name='telephone']").val();
          let content = $("textarea[name='content']").val();

          let errors = {
            name: [],
            email: [],
            telephone: [],
          };

          if (name === "") {
            errors.name.push("Tên không được để trống");
          } else {
            if (name.length < 2) {
              errors.name.push("Tên yêu cầu lớn hơn 2 ký tự");
            }
          }
          if (email === "") {
            errors.email.push("Email không được để trống");
          } else {
            if (!isEmail(email)) {
              errors.email.push("Email sai");
            }
          }
          if (telephone === "") {
            errors.telephone.push("SDT không được để trống");
          } else {
            if (telephone.length < 10 || telephone.length > 11) {
              errors.telephone.push("SDT chỉ được nhập 10 đến 11 kí tự");
            }
          }

          let success = true;
          for (let index in errors) {
            $(`input[name=${index}]`).parent().find(".error").remove();
            if (errors[index].length > 0) {
              success = false;
              let htmlError = `<div class="error" style="color: red;">${errors[index][0]}</div>`;
              $(`input[name=${index}]`).parent().append(htmlError);
            }
          }
        });
      });

      function isEmail(string_email) {
        if (
          /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(
            string_email
          )
        ) {
          return true;
        }
        return false;
      }

      // AJAX

      $.ajax({
        method: "GET",
        url: "http://zuzo.xyz/api/v1/regions",
        success: function (response) {
          response.data.map((item) => {
            let option = `<option value="${item.id}">${item.name}</option>`;
            $("select[name='region']").append(option);
          });
        },
      });
      $("select[name='region']").change(function () {
        let region_id = $(this).val();
        $("select[name='ward']").empty();
        $("select[name='ward']").append(`<option value="\">Chọn xã</option>`);
        $.ajax({
          method: "GET",
          url: `http://zuzo.xyz/api/v1/regions/${region_id}/cities`,
          success: function (response) {
            $("select[name='city']").empty();
            $("select[name='city']").append(
              `<option value="\">Chọn huyện</option>`
            );
            response.data.map((item) => {
              let option = `<option value="${item.id}">${item.name}</option>`;
              $("select[name='city']").append(option);
            });
          },
        });
      });
      $("select[name='city']").change(function () {
        let city_id = $(this).val();
        $.ajax({
          method: "GET",
          url: `http://zuzo.xyz/api/v1/cities/${city_id}/wards`,
          success: function (response) {
            $("select[name='ward']").empty();
            $("select[name='ward']").append(
              `<option value="\">Chọn xã</option>`
            );
            response.data.map((item) => {
              let option = `<option value="${item.id}">${item.name}</option>`;
              $("select[name='ward']").append(option);
            });
          },
        });
      });

      //tags
      $(document).on("keypress", "input[name='tags']", function (e) {
        if (e.keyCode == 13) {
          let valueInput = $(this).val();
          let textTag = `<div class="tag">${valueInput} <span class="remove">x</div> </div>`;
          $(".tags .list").append(textTag);
          $(this).val("");
        }
      });
      $(document).on("click", ".tags .tag .remove", function () {
        $(this).parent().remove();
      });
    </script>
  </body>
</html>
